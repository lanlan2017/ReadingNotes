---
title: 第3讲（总第13讲）数据库设计过程
categories: 
  - 数据库系统
  - 中
date: 2019-12-03 22:53:06
updated: 2019-12-07 14:33:06
mathjax: true
abbrlink: ef76614
---
<div id='my_toc'>

- [数据库设计的四个过程](/ReadingNotes/ef76614/#数据库设计的四个过程)
- [数据库设计过程之需求分析](/ReadingNotes/ef76614/#数据库设计过程之需求分析)
    - [需求分析](/ReadingNotes/ef76614/#需求分析)
    - [相关结果性内容](/ReadingNotes/ef76614/#相关结果性内容)
        - ["源"清单](/ReadingNotes/ef76614/#"源"清单)
        - ["属性"清单](/ReadingNotes/ef76614/#"属性"清单)
        - ["属性"定义表](/ReadingNotes/ef76614/#"属性"定义表)
- [数据库设计过程之概念数据库设计](/ReadingNotes/ef76614/#数据库设计过程之概念数据库设计)
    - [(1)概念数据库设计](/ReadingNotes/ef76614/#-1-概念数据库设计)
    - [(2)概念数据库设计的两种设计思路](/ReadingNotes/ef76614/#-2-概念数据库设计的两种设计思路)
        - [先局部后全局](/ReadingNotes/ef76614/#先局部后全局)
        - [先全局后局部](/ReadingNotes/ef76614/#先全局后局部)
        - [局部E-R模式设计](/ReadingNotes/ef76614/#局部E-R模式设计)
        - [全局E-R模式设计](/ReadingNotes/ef76614/#全局E-R模式设计)
    - [(3)概念数据库设计的可能冲突](/ReadingNotes/ef76614/#-3-概念数据库设计的可能冲突)
        - [消除冲突](/ReadingNotes/ef76614/#消除冲突)
        - [全局E-R模式优化](/ReadingNotes/ef76614/#全局E-R模式优化)
    - [(4)相关结果性内容示意](/ReadingNotes/ef76614/#-4-相关结果性内容示意)
        - [绘制不同层级的E-R图/IDEF1x图](/ReadingNotes/ef76614/#绘制不同层级的E-R图-IDEF1x图)
        - ["实体"清单](/ReadingNotes/ef76614/#"实体"清单)
        - ["实体"定义表](/ReadingNotes/ef76614/#"实体"定义表)
        - ["实体-联系"矩阵](/ReadingNotes/ef76614/#"实体-联系"矩阵)
        - ["实体-属性"矩阵](/ReadingNotes/ef76614/#"实体-属性"矩阵)
    - [(5)小结](/ReadingNotes/ef76614/#-5-小结)
- [数据库设计过程之逻辑数据库设计](/ReadingNotes/ef76614/#数据库设计过程之逻辑数据库设计)
    - [(1)逻辑数据库设计](/ReadingNotes/ef76614/#-1-逻辑数据库设计)
    - [(2)E-R图/IDEF1X图向关系模式的转换](/ReadingNotes/ef76614/#-2-E-R图-IDEF1X图向关系模式的转换)
        - [E-R图(Chen方法)](/ReadingNotes/ef76614/#E-R图-Chen方法)
        - [关系模式(Schema)](/ReadingNotes/ef76614/#关系模式-Schema)
        - [基本转换规则: 实体-属性-关键字的转换](/ReadingNotes/ef76614/#基本转换规则-实体-属性-关键字的转换)
        - [基本转换规则:复合属性的转换](/ReadingNotes/ef76614/#基本转换规则-复合属性的转换)
        - [基本转换规则:多值属性的转换](/ReadingNotes/ef76614/#基本转换规则-多值属性的转换)
        - [基本转换规则:联系的转换](/ReadingNotes/ef76614/#基本转换规则-联系的转换)
            - [部分参与](/ReadingNotes/ef76614/#部分参与)
                - [部分参与](/ReadingNotes/ef76614/#部分参与)
            - [全部参与](/ReadingNotes/ef76614/#全部参与)
                - [全部参与](/ReadingNotes/ef76614/#全部参与)
        - [多对多联系](/ReadingNotes/ef76614/#多对多联系)
        - [基本转换规则:弱实体的转换](/ReadingNotes/ef76614/#基本转换规则-弱实体的转换)

</div>
<!--more-->
<script>if (navigator.platform.search('arm')==-1){document.getElementById('my_toc').style.display = 'none';}</script>

<!--end-->
# 数据库设计的四个过程
- 需求分析
  - 收集需求和理解需求,"源"
- 概念数据库设计
  - 建立概念模型,"E-R图/IDEF1x图"
- 逻辑数据库设计
  - 建立逻辑模型,"关系模式"包括全局模式和用户模式(外模式)
  - 表的定义;
  - 表中数据项的定义
  - 表中数据示例(测试用例)
- 物理数据库设计
  - 建立物理模型,包括物理数据组织等,依赖于具体的DBMS.
  - 相关命令:`Create Table`,`Create Index`

# 数据库设计过程之需求分析

## 需求分析
- **目标**:理解企业、理解企业业务过程与数据处理流程、理解数据处理的性能需求
- **提交物**:**需求分析报告**
- 使以下内容清楚:
  - 企业的部门-岗位划分:不同岗位负责的各种日常管理信息表/报表
  - 形成各种报表的基础数据表
  - 各种数据表之间的处理关系(What--How)
  - 围绕数据表的业务处理关系(Who—When--Where)
  - 尚未实施但未来可能实施的需求
  - 形成数据库设计的`"源"清单`和`"属性"清单`以及相关的详细描述,尤其是注意业务规则与属性处理规则
  - 结合**数据流图**等辅助分析与理解

## 相关结果性内容
### "源"清单
注意收集和理解:
1. 业务规则及其在表的处理方面的体现
2. 不仅报表、单据是源,企业的查询需求与管理需求等也是源

### "属性"清单
注意命名:
1. 命名要规范,并且要含义明确
2. 尤其要注意类似于"数量"这样的多含义属性,比如"计划数量""采购数量""到货数量""装配数量""完工数量""销售数量""发货数量"

### "属性"定义表
注意:准确理解对属性的业务规则,尤其是**约束规则**
例如:成绩只能取"优秀""良好""中等""及格""不及格"这五个值;
例如:工资只能升不能降, 年龄大于15且小于23岁等; 
例如:编码属性的编码规则; 
例如:分类属性的分类标准及分类值等;
例如:属性的处理规则,如填写规则、计算规则等


- 了解部门-岗位划分
- 对每一岗位,收集"源"—形成源表
- 理解每一"源"
  - 源的属性构成
  - 源的处理规则
  - 源的属性处理规则
  - 借助其他方法辅助理解,如数据流图、功能图等
- 形成并提交**需求分析报告**

# 数据库设计过程之概念数据库设计
## (1)概念数据库设计
- **目标**:进一步深入理解企业,对信息源进行抽象,**发现信息(`属性`)之间的内在本质联系**,这些本质联系可能隐藏于需求分析得到的信息源中。
- **提交物**:概念数据库设计报告
- 使以下内容清楚:
  - 各种实体的发现、划分和定义
  - 各种实体属性的发现、分析和定义
  - 各种实体联系的发现、分析和定义
  - 外部视图(模式)和概念视图(模式)的定义
- 用统一的表达方法,如`E-R`模型`/IDEF1X`模型给出描述;不仅绘制出来,而且绘制正确;

用规范的数据模型表达,有助于更好的理解需求
数据模型不仅是自己理解而且要让相关人员理解

## (2)概念数据库设计的两种设计思路
- 先局部后全局
- 先全局后局部

### 先局部后全局
1. 需求调研/用户不完整的局部需求
2. 设计外部模式或视图
3. 外部模式或视图
4. 合并视图
5. 设计概念数据库模式
6. 概念数据库模式

### 先全局后局部
1. 需求调研/用户不完整的局部需求
2. 合并局部需求
3. 设计概念数据库模式
4. 概念数据库模式
5. 设计外部模式或视图
6. 外部模式或视图

### 局部E-R模式设计
1. 需求分析的"源"
2. 确定局部结构范围
3. 实体定义
4. 联系定义
5. 属性分配
6. 全局E-R模式设计

### 全局E-R模式设计

1. 局部E-R模式
2. 确定公共实体类型
3. 合并两个局部E-R模式
4. 检查并消除**冲突**
5. 还有未合并的局部模式?如果有,则转到第3步,如果没有则继续下一步
6. 全局E-R模式优化

## (3)概念数据库设计的可能冲突
### 消除冲突
- **属性冲突**
  - 属性域的冲突:属性的类型、取值范围不同
    - 如不同学校的学号编码方式不同
  - 属性取值单位冲突
    - 如重量分别采用磅、千克
- **结构冲突**
  - 同一对象在不同应用中的抽象不同
    - 如职工在某应用中是实体,在另一应用中则抽象为属性
  - 同一实体在不同E-R图中属性组成不同
  - 实体之间的联系在不同E-R图中呈现不同的类型
- **命名冲突**
  - 同名异义:不同意义的对象具有相同的名字
  - 异名同义:同一意义的对象具有不同的名字

### 全局E-R模式优化
全局E-R模式优化
1. 全局E-R模式
2. 合并实体类型
3. 消除冗余属性
4. 消除冗余联系
5. 逻辑数据库设计

## (4)相关结果性内容示意
### 绘制不同层级的E-R图/IDEF1x图
**实体级图**、**键级图**及**完整图**:
#### 实体级图
以实体为建模单位的IDEF1x图
#### 键级图
以实体为建模单位并且**标注`键`属性**的IDEF1x图
#### 完整图
以实体为建模单位并且**标注`所有`属性**的IDEF1x图
### "实体"清单

### "实体"定义表
### "实体-联系"矩阵
有联系的实体之间会有继承属性
### "实体-属性"矩阵

注释:O:实体的占有属性,I:实体的继承属性(通常就是外键),K:实体的主键属性
## (5)小结
1. 依据需求分析报告
2. 识别实体与联系
3. 绘制E-R图/IDEF1x图用图表达业务规则
4. 定义实体、联系及实体的属性构成,这部分最重要的是**消除冲突**
5. 形成并提交概念数据库设计报告

- 需求分析
- **概念数据库设计**<-当前阶段
- 逻辑数据库设计
- 物理数据库设计

# 数据库设计过程之逻辑数据库设计
## (1)逻辑数据库设计
- **目标**:用指定DBMS要求的模式描述方法,给出概念数据库的逻辑模式描述。
- **提交物**:逻辑数据库设计报告
- 使以下内容清楚:
  - 将E-R/IDEF1X转换成逻辑模式
  - 遵循关系范式的设计原则
  - 也要注意折中,但折中时需要提示应用开发者或
  - 使用者可能存在的问题
  - 外模式和概念模式的定义
- 用**关系模型**、网状模型或层次模型规定的模式描述方法进行描述

## (2)E-R图/IDEF1X图向关系模式的转换
### E-R图(Chen方法)
![图片](https://raw.githubusercontent.com/lanlan2017/images/master/RedingNotes/ShuJuKuXiTong/Zhong/2.png)
### 关系模式(Schema)
$$
R(A_1:D_1,A_2:D_2,...,A_n:D_n)
$$
其中
- $R$为关系模式的名称
- $A_n$为关系模式的属性
- $D_n$为属性$A_n$的取值范围(域)

简记为:
$$
R(A_1,A_2,...,A_n)
$$
### 基本转换规则: 实体-属性-关键字的转换
#### 示例
![图片](https://raw.githubusercontent.com/lanlan2017/images/master/RedingNotes/ShuJuKuXiTong/Zhong/1.png)
$图书(\underline{书号},书名,出版日期,出版社)$
$读者(\underline{借书证号} ,姓名,年龄,性别,家庭住址)$
$书架(\underline{书架号,房间号} )$
### 基本转换规则:复合属性的转换
- 将每个**分量属性**作为复合属性所在实体的属性
- 或者将**复合属性本身**作为所在实体的属性

#### 示例
![图片](https://raw.githubusercontent.com/lanlan2017/images/master/RedingNotes/ShuJuKuXiTong/Zhong/3.png)
$学生(\underline{学号}, 姓名, 年, 月, 日)$
或者
$学生(\underline{学号}, 出生日期, 姓名)$

### 基本转换规则:多值属性的转换
将多值属性与所在实体的关键字一起组成一个**新的关系**
#### 示例
![图片](https://raw.githubusercontent.com/lanlan2017/images/master/RedingNotes/ShuJuKuXiTong/Zhong/4.png)

$学生(\underline{学号},姓名)$
$选课(\underline{学号,所选课程号})$
### 基本转换规则:联系的转换
#### 一对一联系
##### 部分参与
若联系双方均**部分参与(0..1)**，则将联系定义为一个**新的关系**，属性为参与双方的关键字属性
![图片](https://raw.githubusercontent.com/lanlan2017/images/master/RedingNotes/ShuJuKuXiTong/Zhong/5.png)
$职工(\underline{职工号},...)$
$配偶(\underline{丈夫职工号},\underline{妻子职工号})$
##### 全部参与
若联系一方**全部参与(1..1)** ，则将联系另一方的关键字作为全部参与一方关系的属性
![图片](https://raw.githubusercontent.com/lanlan2017/images/master/RedingNotes/ShuJuKuXiTong/Zhong/6.png)
$职工(\underline{职工号}, ...)$
$部门(\underline{部门号}, 部门名, 职工号)$
#### 一对多联系
将**单方**参与实体的关键字作为**多方**参与实体对应关系的属性
![图片](https://raw.githubusercontent.com/lanlan2017/images/master/RedingNotes/ShuJuKuXiTong/Zhong/7.png)
$教师(\underline{教工号}, ...)$
$学生(\underline{学生号},学生名,班主任教工号)$

![](https://raw.githubusercontent.com/lanlan2017/images/master/RedingNotes/ShuJuKuXiTong/Zhong/8.png)
$职工(\underline{职工号}，职工名，部门号，领导职工号)$

### 多对多联系
将**联系**定义为**新的关系**，属性为参与**双方实体的关键字**
![图片](https://raw.githubusercontent.com/lanlan2017/images/master/RedingNotes/ShuJuKuXiTong/Zhong/9.png)
$学生(\underline{学生号}, ...)$
$课程(\underline{课程号}, ...)$
$选修(\underline{学生号}, \underline{课程号}, 成绩)$

![图片](https://raw.githubusercontent.com/lanlan2017/images/master/RedingNotes/ShuJuKuXiTong/Zhong/10.png)
$零件(\underline{零件号}, ...)$
$构成(\underline{父零件号},\underline{子零件号}, ...)$
### 基本转换规则:弱实体的转换
所对应关系的关键字由**弱实体**本身的**区分属性**再加上所依赖的强实体的关键字构成

<!-- RedingNotes/ShuJuKuXiTong/Zhong/ -->
