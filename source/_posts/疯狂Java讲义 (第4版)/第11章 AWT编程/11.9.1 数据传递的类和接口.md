---
title: 11.9.1 数据传递的类和接口
categories: 
  - 疯狂Java讲义 (第4版)
  - 第11章 AWT编程
date: 2019-04-26 01:06:47
updated: 2019-11-02 01:39:01
abbrlink: 9d027ba
---
- [11.9.1 数据传递的类和接口](/ReadingNotes/9d027ba/#11-9-1-数据传递的类和接口)
- [11.9.2 传递文本](/ReadingNotes/9d027ba/#11-9-2-传递文本)
    - [将文本放入剪贴板](/ReadingNotes/9d027ba/#将文本放入剪贴板)
        - [创建一个Clipboard实例](/ReadingNotes/9d027ba/#创建一个Clipboard实例)
        - [将需要放入剪贴板中的字符串封装成StringSelection对象](/ReadingNotes/9d027ba/#将需要放入剪贴板中的字符串封装成StringSelection对象)
        - [调用setContents方法](/ReadingNotes/9d027ba/#调用setContents方法)
    - [从剪贴板中取出数据](/ReadingNotes/9d027ba/#从剪贴板中取出数据)
    - [实例](/ReadingNotes/9d027ba/#实例)

<!--more-->
<script src="https://cdn.bootcss.com/jquery/3.4.0/jquery.slim.min.js"></script>
<script>$(document).ready(function () {$(".post-body > ul:nth-child(1)").hide();});</script>

<!--end-->
# 11.9.1 数据传递的类和接口 #
`AWT`中剪贴板相关操作的接口和类被放在`java.awt.datatransfer`包下，下面是该包下重要的接口和类的相关说明。
- `Clipboard`：代表一个剪贴板实例，这个剪贴板既可以是系统剪贴板，也可以是本地剪贴板。
- `ClipboardOwner`：剪贴板内容的所有者接口，当剪贴板内容的所有权被修改时，系统将会触发该所有者的`lostOwnership`事件处理器。
- `Transferable`：该接口的实例代表放进剪贴板中的传输对象。
- `DataFlavor`：用于表述剪贴板中的数据格式。
- `StringSelection`：`Transferable`的实现类，用于传输文本字符串。
- `FlavorListener`：数据格式监听器接口。
- `FlavorEvent`：该类的实例封装了数据格式改变的事件。

# 11.9.2 传递文本 #
传递文本是最简单的情形，因为`AWT`已经提供了一个`StringSelection`用于传输文本字符串。
## 将文本放入剪贴板 ##
将一段文本内容（字符串对象）放进剪贴板中的步骤如下。
### 创建一个Clipboard实例 ###
既可以创建系统剪贴板，也可以创建本地剪贴板。
**创建系统剪贴板**通过如下代码：
```java
Clipboard clipboard= Toolkit.getDefaultToolkit().getSystemClipboard();
```
**创建本地剪贴板**通过如下代码：
```java
Clipboard clipboard =new Clipboard("cb");
```
### 将需要放入剪贴板中的字符串封装成StringSelection对象 ###
如下代码所示:
```java
StringSelection st =new StringSelection(targetStr);
```
### 调用setContents方法 ###
**调用剪贴板对象的setContents()方法将StringSelection放进剪贴板中**，该方法需要两个参数，
- 第一个参数是`Transferable`对象，代表放进剪贴板中的对象；
- 第二个参数是`ClipboardOwner`对象，代表剪贴板数据的所有者，通常无须关心剪贴板数据的所有者，所以把第二个参数设为`null`。

```java
clipboard.setContents(st,null);
```
## 从剪贴板中取出数据 ##
从剪贴板中取出数据则比较简单，**调用`Clipboard`对象的`getData`(`DataFlavorflavor`)方法即可取出剪贴板中指定格式的内容**，如果指定`flavor`的数据不存在，该方法将引发`UnsupportedFlavorException`异常。为了避免出现异常，可以先调用`Clipboard`对象的`isDataFlavorAvailable(DataFlavorflavor)`来判断指定`flavor`的数据是否存在。如下代码所示:
```java
if (clipboard. isDataFlavorAvailable(DataFlavor.stringFlavor))
{
    String content =(String)clipboard.getData(DataFlavor.stringFlavor));
}
```
## 实例 ##
下面程序是一个利用系统剪贴板进行复制、粘贴的简单程序。
```java
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;
import java.awt.datatransfer.*;
public class SimpleClipboard
{
	private Frame f = new Frame("简单的剪贴板程序");
	// 获取系统剪贴板
	private Clipboard clipboard = Toolkit
		.getDefaultToolkit().getSystemClipboard();
	// 下面是创建本地剪贴板的代码
	// Clipboard clipboard = new Clipboard("cb");   // ①
	// 用于复制文本的文本框
	private TextArea jtaCopyTo = new TextArea(5,20);
	// 用于粘贴文本的文本框
	private TextArea jtaPaste = new TextArea(5,20);
	private Button btCopy = new Button("复制"); // 复制按钮
	private Button btPaste = new Button("粘贴"); // 粘贴按钮
	public void init()
	{
		Panel p = new Panel();
		p.add(btCopy);
		p.add(btPaste);
		btCopy.addActionListener(event ->
		{
			// 将一个多行文本域里的字符串封装成StringSelection对象
			StringSelection contents = new
				StringSelection(jtaCopyTo.getText());
			// 将StringSelection对象放入剪贴板
			clipboard.setContents(contents, null);
		});
		btPaste.addActionListener(event ->
		{
			// 如果剪贴板中包含stringFlavor内容
			if (clipboard.isDataFlavorAvailable(DataFlavor.stringFlavor))
			{
				try
				{
					// 取出剪贴板中stringFlavor内容
					String content = (String)clipboard
						.getData(DataFlavor.stringFlavor);
					jtaPaste.append(content);
				}
				catch (Exception e)
				{
					e.printStackTrace();
				}
			}
		});
		// 创建一个水平排列的Box容器
		Box box = new Box(BoxLayout.X_AXIS);
		// 将两个多行文本域放在Box容器中
		box.add(jtaCopyTo);
		box.add(jtaPaste);
		// 将按钮所在Panel、Box容器添加到Frame窗口中
		f.add(p,BorderLayout.SOUTH);
		f.add(box,BorderLayout.CENTER);
		f.pack();
		f.setVisible(true);
	}
	public static void main(String[] args)
	{
		new SimpleClipboard().init();
	}
}
```
上面程序中“复制”按钮的事件监听器负责将第一个文本域的内容复制到系统剪贴板中，“粘贴”按钮的事件监听器则负责取出系统剪贴板中的`stringFlavor`内容，并将其添加到第二个文本域内。运行上面程序，将看到如图11.32所示的结果。
因为程序使用的是系统剪贴板，因此可以通过`Windows`的剪贴簿查看器来查看程序放入剪贴板中的内容。在`Windows`的“开始”菜单中运行“`clipbrd`”程序，将可以看到如图11.33所示的窗口。
**提示：**
**`Windows7`系统已经删除了默认的剪贴板查看器**，因此读者可以到`WindowsXP`的`C:\windows\system32\`目录下将`clipbrd.exe`文件复制过来。

